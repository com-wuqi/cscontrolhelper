# 前后端核心接口清单

json返回内容, 严格遵循大小写, id 字段是数据库内的 id

## 一、玩家端核心接口

| 接口名称 | 请求方式 | 请求URL                | 请求参数                                                 | 返回参数核心字段                                                       | 核心逻辑 / 筛选规则                |
|------|------|----------------------|------------------------------------------------------|----------------------------------------------------------------|----------------------------|
| 玩家登录 | POST | `/api/player/login`  | `student_id: int && password: str`                   | `secret_key: str && student_id: int && name: str && team: str` | 验证学号 + 密码有效性, 给出secret_key |
| 扫码击杀 | POST | `/api/player/scan`   | `secret_key: str && student_id: int && kill_id: int` | `result: 0 (失败) or result: 1 (成功)`                             | 校验攻击合法性（仅可攻击敌方），更新阵亡状态     |

扫码击杀 完成 message_queue.put

## 二、管理员端核心接口

| 接口名称    | 请求方式 | 请求URL                    | 请求参数                                                               | 返回参数核心字段                            | 核心逻辑              |
|---------|------|--------------------------|--------------------------------------------------------------------|-------------------------------------|-------------------|
| 管理员登录   | POST | `/api/admin/login`       | `user: str && password: str`                                       | `secret_key: str && id: int`        | 验证管理员账号密码有效性      |
| 手动复活玩家  | POST | `/api/admin/resurrect`   | `secret_key: str && id: int && student_id: int`                    | `result: 0 (失败) or result: 1 (成功)`  | 恢复指定玩家存活状态，重置扫码权限 |
| 修改玩家密码  | POST | 	`/api/admin/changePwd`	 | `secret_key: str && id: int && student_id: int && changedPwd: str` | 	`result: 0 (失败) or result: 1 (成功)` | 修改密码              |
| SSE广播信息 | POST | 	`/api/public/sseSend`	  | `secret_key: str && id: int && message: str`                       | 	`result: 0 (失败) or result: 1 (成功)` | sse               |

SSE广播信息 完成 message_queue.put

## 三、公共接口

| 接口名称    | 请求方式 | 请求URL                | 请求参数 | 返回参数核心字段                                                       | 
|---------|------|----------------------|------|----------------------------------------------------------------|
| 获取当前战况  | GET  | `/api/public/status` | 无    | `{ {name: str,is_alive: bool,kill: List[int]},team: str},...}` |      
| SSE广播接收 | GET  | `/api/public/sse`    | 无    | `"{time}: {name_1} 击杀了 {name_2} "`                             |      







# 真人CS对战管理系统需求文档（补充版）
## 一、项目概述
本系统为真人CS线下对战提供数字化管理工具，支持玩家扫码交互、战况记录、队伍分配及管理员监控，适配手机端强制横屏使用。


## 二、用户角色
1. **普通玩家**：通过学号登录，使用扫码功能参与对战，接收阵亡提示。
2. **管理员**：查看全局战况、地图、队伍信息，执行玩家复活操作。


## 三、核心功能列表
### （一）基础配置功能
| 功能项 | 详细说明 |
|--------|----------|
| 页面适配 | 前端页面强制横屏展示，适配主流手机分辨率 |
| 玩家规模配置 | 支持20-28名偶数玩家参与对战 |
| 队伍自动分配 | 系统随机将玩家分配为红/蓝两队，每队10-14人 |


### （二）玩家端功能
| 功能项 | 详细说明 | 优先级 |
|--------|----------|--------|
| 玩家登录 | 支持学号 + 手机号后六位密码登录；登录凭证为学号生成的静态二维码（QRCode，30%容错率） | 高 |
| 扫码识别 | 调用手机摄像头扫描其他玩家学号二维码，触发对战交互 | 高 |
| 击杀规则校验 | 仅允许扫描敌方玩家二维码，扫描己方玩家二维码无响应 | 高 |
| 阵亡状态触发 | 被敌方扫描后，弹出“您已被{对方学号}扫描，您已阵亡”提示，同步禁用扫码功能 | 高 |
| 存活状态校验 | 提供玩家存活状态&扫码权限校验接口，实时判断玩家是否具备扫码权限 | 高 |
| 己方战况查看 | 查看当前击杀记录（谁扫描了谁）、己方存活玩家列表 | 高 |
| 玩家地图功能 | 展示对战场地布局地图（仅查看，无定位等附加功能） | 低 |


### （三）管理员端功能
| 功能项 | 详细说明 | 优先级 |
|--------|----------|--------|
| 管理员登录 | 支持管理员账号+密码登录，获取管理端操作权限 | 高 |
| 全局地图展示 | 展示对战场地布局地图，直观呈现对战场景 | 低 |
| 全局战况统计 | 实时更新全场击杀记录、红/蓝两队存活/阵亡人数 | 高 |
| 队伍信息查看 | 展示红/蓝两队完整玩家列表，标注每位玩家存活/阵亡状态 | 高 |
| 玩家手动复活 | 可选择指定阵亡玩家，恢复其存活状态及扫码功能 | 高 |
| 队伍分配查看 | 查看红/蓝两队最终的玩家分配清单 | 中 |
| 修改密码 |修改玩家密码|中|


## 四、非功能需求
| 需求类型 | 详细要求 |
|----------|----------|
| 兼容性 | 支持主流手机浏览器（Chrome、Safari、微信内置浏览器） |
| 响应速度 | 扫码识别、玩家状态更新延迟≤1秒 |
| 稳定性 | 支持28人同时在线操作，无卡顿、数据丢失等问题 |



# 真人CS对战管理系统需求文档

## 一、项目概述
本系统为真人CS线下对战提供数字化管理工具，支持玩家扫码交互、战况记录、队伍分配及管理员监控，适配手机端强制横屏使用。


## 二、用户角色
- **普通玩家**：通过学号登录，使用扫码功能参与对战，接收阵亡提示。
- **管理员**：查看全局战况、地图、队伍信息，执行玩家复活操作，支持修改用户密码。


## 三、核心功能需求
### （一）基础配置
- **适配要求**：前端页面强制横屏，适配主流手机分辨率。
- **玩家规模**：支持20-28名偶数玩家，自动随机分配为红/蓝两队（每队10-14人）。


### （二）玩家端功能
#### 登录模块
- 登录方式：学号 + 手机号后6位。

#### 对战交互
- 扫码功能：调用手机摄像头扫描其他玩家的学号二维码。
- 击杀规则：仅可扫描敌方玩家二维码，扫描己方二维码无响应。
- 阵亡提示：被敌方扫描后，弹出“您已被{对方学号}扫描，您已阵亡”提示，且无法再使用扫码功能。

#### 信息查看
- 可查看当前击杀情况（谁扫描了谁）、己方在场玩家列表。


### （三）管理员端功能
#### 全局监控页面
- 地图显示：展示对战场地布局。
- 战况统计：实时更新击杀记录、双方存活/阵亡人数。
- 队伍信息：显示红/蓝两队玩家列表及状态（存活/阵亡）。

#### 操作功能
- 手动复活：可选择指定阵亡玩家，恢复其扫码功能。


## 四、非功能需求
- **兼容性**：支持主流手机浏览器。
- **响应速度**：扫码识别、状态更新延迟≤1秒。
- **稳定性**：支持28人同时在线，无卡顿/数据丢失。